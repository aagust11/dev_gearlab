<!--
By Frank Leenaars, Department of Instructional Technology, University of Twente
Source code at https://github.com/frankleenaars/gearlab
Licensed under the MIT license

Demo hand icon by momentum (http://momentumdesignlab.com/)
-->
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>GearLab</title>
    <link rel="icon" type="image/png" href="img/Gear.png">
    <script type="text/javascript" src="hammer.min.js"></script>
    <script type="text/javascript" src="gearlab.js"></script>
    <style type="text/css">
        html, body {
            height: 100%;
            margin: 0;
            font-family: "Inter", "Segoe UI", sans-serif;
            background: #f4f6fb;
            color: #1f2937;
            overflow: hidden;
        }

        .app-shell {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .canvas-wrapper {
            position: relative;
            flex: 1;
            overflow: hidden;
        }

        .top-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 24px;
            background: rgba(15, 23, 42, 0.9);
            color: #f8fafc;
            box-shadow: 0 8px 18px rgba(15, 23, 42, 0.35);
            position: relative;
            z-index: 20;
            flex-shrink: 0;
        }

        .top-bar-title {
            font-size: 18px;
            font-weight: 700;
            letter-spacing: 0.04em;
        }

        .top-menu {
            display: flex;
            gap: 12px;
        }

        .top-menu button {
            border: none;
            background: rgba(248, 250, 252, 0.12);
            color: #f8fafc;
            font-weight: 600;
            font-size: 13px;
            padding: 8px 16px;
            border-radius: 999px;
            cursor: pointer;
            box-shadow: 0 6px 12px rgba(15, 23, 42, 0.3);
            transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
            backdrop-filter: blur(6px);
        }

        .top-menu button:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 18px rgba(15, 23, 42, 0.35);
            background: rgba(248, 250, 252, 0.18);
        }

        .top-menu button:active {
            transform: translateY(0);
            box-shadow: 0 4px 10px rgba(15, 23, 42, 0.35);
            background: rgba(248, 250, 252, 0.24);
        }

        #gearlab_canvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        .gear-editor {
            position: absolute;
            min-width: 220px;
            background: rgba(255, 255, 255, 0.96);
            border-radius: 12px;
            box-shadow: 0 12px 40px rgba(15, 23, 42, 0.18);
            padding: 16px 20px;
            pointer-events: auto;
            border: 1px solid rgba(148, 163, 184, 0.35);
            z-index: 10;
        }

        .gear-editor.hidden {
            display: none;
        }

        .gear-editor h3 {
            margin: 0 0 12px;
            font-size: 16px;
            font-weight: 600;
            color: #0f172a;
        }

        .gear-editor-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            margin-bottom: 10px;
            font-size: 13px;
        }

        .gear-editor-row:last-child {
            margin-bottom: 0;
        }

        .gear-editor-row label,
        .gear-editor-row span {
            font-weight: 600;
            color: #1f2937;
        }

        .gear-editor-row input[type="number"] {
            width: 80px;
            padding: 6px 8px;
            border-radius: 6px;
            border: 1px solid #cbd5f5;
            background: #f8fafc;
            font-size: 13px;
            color: #0f172a;
        }

        .gear-editor-row input[type="number"]:disabled {
            opacity: 0.6;
            background: #e2e8f0;
            cursor: not-allowed;
        }

        .direction-toggle {
            position: relative;
            display: inline-flex;
            align-items: center;
        }

        .direction-toggle input {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        .toggle-track {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            background: #e2e8f0;
            border-radius: 999px;
            padding: 4px 14px;
            font-size: 14px;
            position: relative;
            color: #334155;
        }

        .toggle-option {
            font-weight: 600;
        }

        .toggle-thumb {
            position: absolute;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #34d399;
            top: 50%;
            transform: translate(-90%, -50%);
            transition: transform 0.2s ease;
            box-shadow: 0 4px 12px rgba(13, 148, 136, 0.4);
        }

        .direction-toggle input:checked + .toggle-track .toggle-thumb {
            transform: translate(50%, -50%);
            background: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.45);
        }

        .gear-editor-mode {
            gap: 18px;
        }

        .gear-editor-mode label {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-weight: 600;
        }

        .gear-editor-mode input[type="radio"] {
            accent-color: #2563eb;
        }

        .site-footer {
            text-align: center;
            font-size: 12px;
            padding: 18px 16px;
            color: #1f2937;
            background: rgba(148, 163, 184, 0.18);
            flex-shrink: 0;
            transition: max-height 0.3s ease, padding 0.3s ease, background 0.3s ease;
            max-height: 120px;
            overflow: visible;
            position: relative;
        }

        .site-footer.collapsed {
            max-height: 0;
            padding: 0;
            background: transparent;
        }

        .footer-inner {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            position: relative;
            white-space: nowrap;
            gap: 0;
        }

        .footer-content {
            display: inline-flex;
            align-items: center;
            white-space: nowrap;
            gap: 0;
            overflow: hidden;
            transition: opacity 0.3s ease, max-height 0.3s ease;
            max-height: 60px;
            flex: 1 1 auto;
        }

        .site-footer.collapsed .footer-inner {
            pointer-events: none;
        }

        .site-footer.collapsed .footer-content {
            opacity: 0;
            max-height: 0;
            pointer-events: none;
            flex-basis: 0;
            width: 0;
        }

        .footer-license {
            flex: 0 0 auto;
        }

        .footer-icons {
            display: inline-flex;
            align-items: center;
            gap: 0;
            margin-left: 2cm;
        }

        .footer-icons img {
            height: 14.4px;
        }

        .footer-version {
            margin-left: 4cm;
            flex: 0 0 auto;
        }

        .footer-toggle {
            border: none;
            background: rgba(15, 23, 42, 0.08);
            color: #0f172a;
            width: 28px;
            height: 28px;
            border-radius: 6px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s ease, color 0.2s ease;
            margin-left: auto;
        }

        .footer-toggle:hover {
            background: rgba(15, 23, 42, 0.16);
            color: #0b1120;
        }

        .site-footer.collapsed .footer-toggle {
            position: fixed;
            bottom: 16px;
            right: 24px;
            margin: 0;
            background: rgba(15, 23, 42, 0.12);
            box-shadow: 0 6px 18px rgba(15, 23, 42, 0.25);
            pointer-events: auto;
            z-index: 40;
        }
    </style>
</head>
<body onload="new window.gearlab.GearLab();">
    <div class="app-shell">
        <header class="top-bar">
            <div class="top-bar-title">GearLab</div>
            <nav class="top-menu">
                <button id="new-escena" type="button">Escena en blanc</button>
                <button id="import-escena" type="button">Carregar escena</button>
                <button id="download-escena" type="button">Descarregar escena</button>
                <button id="start-simulation" type="button">Iniciar simulació</button>
                <button id="start-demo" type="button">Iniciar demo</button>
            </nav>
            <input id="escena-file-input" type="file" accept=".glb,.gearlab,.json,.bin" hidden />
        </header>
        <div class="canvas-wrapper">
            <canvas id="gearlab_canvas"></canvas>
            <div id="gear-editor" class="gear-editor hidden">
                <div class="gear-editor-row">
                    <label for="gear-editor-teeth">Nombre de dents</label>
                    <input id="gear-editor-teeth" type="number" min="8" />
                </div>
                <div class="gear-editor-row">
                    <label for="gear-editor-rpm">RPM</label>
                    <input id="gear-editor-rpm" type="number" min="0" step="0.01" />
                </div>
                <div class="gear-editor-row gear-editor-toggle">
                    <span>Sentit de gir</span>
                    <label class="direction-toggle">
                        <input id="gear-editor-direction" type="checkbox" />
                        <span class="toggle-track">
                            <span class="toggle-option">←</span>
                            <span class="toggle-thumb"></span>
                            <span class="toggle-option">→</span>
                        </span>
                    </label>
                </div>
                <div class="gear-editor-row gear-editor-mode">
                    <span>Mode</span>
                    <label for="gear-editor-mode-driver"><input type="radio" name="gear-mode" id="gear-editor-mode-driver" value="driver" /> Motriu</label>
                    <label for="gear-editor-mode-driven"><input type="radio" name="gear-mode" id="gear-editor-mode-driven" value="driven" /> Conduïda</label>
                </div>
            </div>
        </div>
        <footer class="site-footer" id="page-footer">
            <div class="wrap footer-inner">
                <div class="footer-content">
                    <div class="footer-license" data-i18n="footer.license" data-i18n-type="html">GearLab © 2025 per <a href="mailto:aagust11@xtec.cat">aagust11@xtec.cat</a> amb l'assistència de la IA està llicenciat sota <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>.</div>
                    <div class="footer-icons" aria-hidden="true">
                        <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" alt="Creative Commons" />
                        <img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" alt="Reconeixement" />
                        <img src="https://mirrors.creativecommons.org/presskit/icons/nc.svg" alt="No Comercial" />
                        <img src="https://mirrors.creativecommons.org/presskit/icons/sa.svg" alt="Compartir Igual" />
                    </div>
                    <div class="footer-version" data-i18n="footer.version">Versió 1 · Octubre 2025</div>
                </div>
                <button type="button" class="footer-toggle" id="footer-toggle" aria-controls="page-footer" aria-expanded="true" title="Amaga el peu de pàgina">▼</button>
            </div>
        </footer>
    </div>
    <script>
        (function () {
            const footer = document.getElementById('page-footer');
            const toggle = document.getElementById('footer-toggle');

            if (!footer || !toggle) {
                return;
            }

            const updateToggleState = (collapsed) => {
                toggle.setAttribute('aria-expanded', String(!collapsed));
                toggle.textContent = collapsed ? '▲' : '▼';
                toggle.title = collapsed ? 'Mostra el peu de pàgina' : 'Amaga el peu de pàgina';
            };

            toggle.addEventListener('click', () => {
                const collapsed = footer.classList.toggle('collapsed');
                updateToggleState(collapsed);
            });
        })();
    </script>
</body>
</html>
